<!DOCTYPE html>
<html>

<head>
    <title>Genre Distribution of Movies</title>
    <style>
        /* CSS styling remains the same */
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .chart {
            margin: 20px;
        }

        .bar {
            fill: steelblue;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .bar:hover {
            fill: darkblue;
            opacity: 1;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 2;
        }

        .axis-x,
        .axis-y {
            font-size: 12px;
        }

        .legend-text {
            font-size: 14px;
        }

        .nav-button {
            font-size: 16px;
            padding: 10px 20px;
            background-color: steelblue;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        #pieChartPercentage {
            font-size: 20px;
            font-weight: bold;
            display: none;
            text-anchor: middle;
        }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <h1>Movie Data Visualizations</h1>
    <div id="charts-container">
        <div id="pieChart" class="chart"></div>
    </div>
    <div id="pieChartPercentage"></div>

    <script>
        d3.json("data.json").then(function (data) {
            const width = 400;
            const height = 400;
            const radius = Math.min(width, height) / 2;

            const svgPie = d3
                .select("#pieChart")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

            const color = d3.scaleOrdinal(d3.schemeCategory10);

            const pie = d3
                .pie()
                .value((d) => d.count)
                .sort(null);

            const arc = d3.arc().innerRadius(0).outerRadius(radius);

            const path = svgPie
                .selectAll("path")
                .data(pie(data))
                .enter()
                .append("path")
                .attr("d", arc)
                .attr("fill", (d) => (d.data.genre ? color(d.data.genre) : "white"))
                .attr("stroke", "white")
                .style("stroke-width", "2px")
                .on("mouseover", handlePieMouseover)
                .on("mouseout", handlePieMouseout);

            const legend = svgPie
                .selectAll(".legend")
                .data(pie(data))
                .enter()
                .append("g")
                .attr("class", "legend")
                .attr("transform", function (d, i) {
                    return "translate(" + (-width / 2 + 10) + "," + (-height / 2 + 20 + i * 30) + ")";
                });

            legend
                .append("rect")
                .attr("width", 20)
                .attr("height", 20)
                .style("fill", (d) => (d.data.genre ? color(d.data.genre) : "white"));

            legend
                .append("text")
                .attr("x", 30)
                .attr("y", 15)
                .text((d) => (d.data.genre ? d.data.genre : "N/A"))
                .attr("class", "legend-text");

            function handlePieMouseover(event, d) {
                const percentage = ((d.data.count / data.reduce((sum, genreData) => sum + genreData.count, 0)) * 100).toFixed(2);
                path.attr("opacity", 0.7);
                d3.select(event.currentTarget).attr("opacity", 1);
                d3.select("#pieChartPercentage")
                    .text(`${percentage}%`)
                    .style("display", "block");
            }

            function handlePieMouseout(event, d) {
                path.attr("opacity", 1);
                d3.select("#pieChartPercentage").style("display", "none");
            }
        });
    </script>
</body>

</html>
